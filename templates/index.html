<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ObjectMeter â€” Misura con AI</title>
  <meta name="description"
    content="Carica una foto, seleziona un oggetto e ottieni la dimensione reale grazie a YOLOv8." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/static/style.css" />
</head>

<body>

  <!-- â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <header>
    <div class="logo-icon">ğŸ“</div>
    <h1>ObjectMeter</h1>
    <span class="badge">YOLOv8 AI</span>
  </header>

  <!-- â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <main>

    <!-- How-to card -->
    <div class="card">
      <h2>ğŸ“‹ Come funziona</h2>
      <ol class="guide-steps">
        <li>
          <span class="step-icon">ğŸ“¸</span>
          <div>
            <strong>Carica o scatta una foto</strong>
            <span class="step-desc">Assicurati che nella scena ci sia almeno un oggetto comune (persona, bottiglia,
              sediaâ€¦)</span>
          </div>
        </li>
        <li>
          <span class="step-icon">âœï¸</span>
          <div>
            <strong>Disegna un rettangolo</strong>
            <span class="step-desc">Clicca e trascina sull'immagine per selezionare l'oggetto da misurare</span>
          </div>
        </li>
        <li>
          <span class="step-icon">ğŸ¤–</span>
          <div>
            <strong>L'AI fa il resto</strong>
            <span class="step-desc">YOLOv8 rileva oggetti noti, calcola il rapporto pixel/cm e ti dÃ  le dimensioni
              reali</span>
          </div>
        </li>
      </ol>
    </div>

    <!-- Input card -->
    <div class="card">
      <h2>ğŸ“ Carica immagine</h2>

      <!-- Drop zone -->
      <div id="drop-zone" class="drop-zone">
        <span class="drop-icon">ğŸ“</span>
        <span class="drop-text">Trascina qui la foto oppure <strong>clicca per selezionare</strong></span>
        <span class="drop-hint">JPG, PNG â€” con almeno un oggetto di riferimento visibile</span>
        <input id="file-input" type="file" accept="image/*" />
      </div>

      <div class="camera-action" id="camera-action-wrapper">
        <span class="camera-or">â€” oppure â€”</span>
        <button id="btn-camera" class="btn btn-outline">ğŸ“· Scatta una foto</button>
      </div>

      <!-- Canvas area (hidden until image loaded) -->
      <div id="canvas-wrapper" class="canvas-wrapper" style="display:none;">
        <canvas id="main-canvas"></canvas>
        <div class="canvas-hint" id="canvas-hint">
          âœï¸ Clicca e trascina per disegnare il rettangolo sull'oggetto da misurare
        </div>
      </div>

      <!-- Action buttons -->
      <div class="action-bar" id="action-bar" style="display:none;">
        <button id="btn-clear" class="btn btn-outline" title="Rimuovi immagine">ğŸ—‘ï¸ Nuova foto</button>
        <button id="btn-measure" class="btn btn-primary" disabled>
          <div class="spinner"></div>
          ğŸ“ Misura
        </button>
      </div>
    </div>

    <!-- Results card -->
    <div id="result-card" class="card result-card">
      <h2>ğŸ“Š Risultati</h2>

      <!-- Annotated image (view mode) -->
      <div class="annotated-wrapper" id="annotated-wrapper" style="display:none;">
        <img id="annotated-img" class="annotated-img" alt="Immagine annotata" />
      </div>

      <!-- Edit mode canvas (hidden by default) -->
      <div class="edit-canvas-wrapper" id="edit-canvas-wrapper" style="display:none;">
        <canvas id="edit-canvas"></canvas>
        <div class="edit-hint">â†”ï¸ Trascina per spostare Â· ğŸ”² Trascina gli angoli per ridimensionare</div>
      </div>

      <!-- Edit action buttons -->
      <div class="edit-action-bar" id="edit-action-bar" style="display:none;">
        <button id="btn-save-edit" class="btn btn-primary">
          <div class="spinner"></div>
          ğŸ’¾ Salva modifica
        </button>
        <button id="btn-cancel-edit" class="btn btn-outline">âŒ Annulla</button>
      </div>

      <!-- Detected reference info -->
      <div class="ref-info" id="ref-info" style="display:none;">
        <div class="ref-badge" id="ref-badge"></div>
      </div>

      <!-- Dimensions -->
      <div class="dim-grid">
        <div class="dim-box">
          <div class="label">Larghezza</div>
          <div class="value" id="res-width">â€”</div>
          <div class="unit">cm</div>
        </div>
        <div class="dim-box">
          <div class="label">Altezza</div>
          <div class="value" id="res-height">â€”</div>
          <div class="unit">cm</div>
        </div>
      </div>

      <!-- Edit button -->
      <div class="edit-bar" id="edit-bar" style="display:none;">
        <button id="btn-edit" class="btn btn-outline">âœï¸ Modifica selezione</button>
      </div>

      <!-- All detections list -->
      <details class="detections-details" id="detections-details" style="display:none;">
        <summary class="detections-toggle">ğŸ” Tutti gli oggetti rilevati</summary>
        <ul class="detections-list" id="detections-list"></ul>
      </details>
    </div>

  </main>

  <!-- â”€â”€ Camera Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="camera-modal" class="camera-modal" style="display:none;">
    <div class="camera-container">
      <video id="camera-stream" autoplay playsinline></video>
      <div class="camera-controls">
        <button id="btn-take-photo" class="btn-capture">ğŸ”´ Scatta</button>
        <button id="btn-close-camera" class="btn btn-outline" style="color: white; border-color: white;">âŒ
          Chiudi</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="toast" role="alert">
    <span id="toast-msg"></span>
  </div>

  <script src="/static/script.js"></script>
</body>

</html>